!function(o){function t(t){for(var e,n,a=t[0],s=t[1],i=t[2],r=0,u=[];r<a.length;r++)n=a[r],Object.prototype.hasOwnProperty.call(l,n)&&l[n]&&u.push(l[n][0]),l[n]=0;for(e in s)Object.prototype.hasOwnProperty.call(s,e)&&(o[e]=s[e]);for(p&&p(t);u.length;)u.shift()();return d.push.apply(d,i||[]),c()}function c(){for(var t,e=0;e<d.length;e++){for(var n=d[e],a=!0,s=1;s<n.length;s++){var i=n[s];0!==l[i]&&(a=!1)}a&&(d.splice(e--,1),t=r(r.s=n[0]))}return t}var n={},l={0:0},d=[];function r(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return o[t].call(e.exports,e,e.exports,r),e.l=!0,e.exports}r.m=o,r.c=n,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="./";var e=(a=window.webpackJsonp=window.webpackJsonp||[]).push.bind(a);a.push=t;for(var a=a.slice(),s=0;s<a.length;s++)t(a[s]);var p=e;d.push([48,1]),c()}({48:function(t,e,n){t.exports=n(49)},49:function(t,e,n){"use strict";n(50);var a,s=n(51);((a=s)&&a.__esModule?a:{"default":a})["default"]["new"]().attach(document.body)},50:function(t,e,n){},51:function(t,e,n){"use strict";e.__esModule=!0,n(52),n(57),n(58),n(75),n(77),n(45),n(78),n(79),n(80),n(81),n(83),n(87),n(88),n(89),n(90),n(91);var a=n(92);function s(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}console.log;var o=function o(){for(var t=0,e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];for(var s=0,i=n;s<i.length;s++)t+=i[s];return t},n=function(){function t(){var n=this;s(this,"clearData",function(){a.database.clear(),n.savedItems=[],n.currentItem=null,n.pause=!0,n.update()}),s(this,"onTextareaChange",function(t){13===t.keyCode&&(t.preventDefault(),0!==(t=t.target).value.trim().length&&(n.createItem(t.value),t.value=""))}),s(this,"pause",function(){var t,e;n.currentItem&&(t=Date.now(),(e=n.currentItem.timeRanges)[e.length-1].end=t),n.updateStatus(!1)}),s(this,"start",function(){var t;n.currentItem&&(t=Date.now(),n.currentItem.timeRanges.push({start:t})),n.updateStatus(!0)}),s(this,"finish",function(){var t,e;n.currentItem&&(t=Date.now(),(e=n.currentItem.timeRanges)[e.length-1].end=t,n.savedItems.push(n.currentItem),n.currentItem=null,n.update()),n.updateStatus(!1)}),s(this,"onListClick",function(t){var e=t.target,t=e.closest(".timeline-item");t&&(t=t.dataset.id,e.classList.contains("timeline-item-text")||e.parentElement.classList.contains("timeline-item-text")||(n.selectedItems.has(t)?n.selectedItems["delete"](t):n.selectedItems.add(t),n.update()))}),this.currentItem=null,this.savedItems=[],this.elt=null,this.selectedItems=new Set,this.running=!0,this.updateStatus(),this.load()}t["new"]=function(){return new this};var e=t.prototype;return e.debug=function(){this.savedItems=[{id:"1",text:"test 111",timeRanges:[{start:Date.now()-1e6,end:Date.now()}]},{id:"2",text:"test 333",timeRanges:[{start:Date.now()-1e6,end:Date.now()}]}],this.selectedItems.add("1"),this.selectedItems.add("2")},e.load=function(){var t=a.database.load();t&&(this.savedItems=t.saved||[],this.currentItem=t.current||null)},e.loopSave=function(){var t=this,e={saved:this.savedItems,current:this.currentItem};a.database.save(e),setTimeout(function(){t.loopSave()},1e3)},e.uid=function(){return Math.random().toString().slice(-5,-1)+"-"+Date.now().toString().slice(-4)},e.createItem=function(t){var e,n,a=Date.now();this.currentItem&&((n=(e=this.currentItem).timeRanges[e.timeRanges.length-1]).end||(n.end=a),this.savedItems.push(e)),console.log(this.savedItems,this.currentItem),this.currentItem={id:this.uid(),text:t,timeRanges:[{start:a}]},this.selectedItems.add(this.currentItem.id),this.updateStatus(!0),this.update()},e.bindListEvents=function(t){var s=this;t.querySelectorAll("div[contenteditable]").forEach(function(a){a.addEventListener("blur",function(t){var e=a.closest(".timeline-item").dataset.id,n=null;(n=s.currentItem&&s.currentItem.id===e?s.currentItem:s.savedItems.find(function(t){return t.id===e}))&&(t=t.target.innerHTML,n.text=t)})})},e.update=function(){var s=this,t=this.elt.querySelector(".item-list"),a=function a(t,e,n){for(void 0===n&&(n="0"),t=String(t);t.length<e;)t=n+t;return t},i=function i(t){t=new Date(t);return a(t.getHours(),2)+":"+a(t.getMinutes(),2)},r=function r(t){var e=Math.floor(t/1e3),n=Math.floor(e/60),t="";return n&&(t+=n+"m"),(e%=60)&&(t+=e+"s"),t},u=function u(t){var e=t.timeRanges.map(function(t){var e=i(t.start)+"~";return t.end&&(e+=""+i(t.end)),"<div>"+e+"</div>"}).join(""),n=0;t.timeRanges.forEach(function(t){t.start&&t.end&&(n+=t.end-t.start)});var a=r(n);return'\n        <div\n          class="timeline-item '+(s.selectedItems.has(t.id)?"selected":"")+'"\n          data-id="'+t.id+'"\n        >\n          <span>'+e+'</span>\n          <div class="timeline-item-text" contenteditable="true">'+t.text+"</div>\n          <span>"+a+"</span>\n        </div>\n      "},e=this.savedItems.filter(function(t){return s.selectedItems.has(t.id)}),e=o.apply(void 0,e.map(function(t){return o.apply(void 0,t.timeRanges.map(function(t){return t.end-t.start}))})),e=r(e),e="\n    <div>\n      <span>时间段</span>\n      <span>描述</span>\n      <span>计时</span>\n    </div>\n    "+this.savedItems.map(u).join("")+"\n    "+(this.currentItem?u(this.currentItem):"")+'\n    <div class="timeline-stat-item">\n      <span>统计选中项时间</span>\n      <span>'+e+"</span>\n      <span></span>\n    </div>\n    ";t.innerHTML=e,this.bindListEvents(t)},e.updateTotal=function(){},e.updateStatus=function(t){this.elt&&(this.elt.querySelector(".editor-status-text").innerHTML=t?"计时中...":"计时暂停"),this.running=t},e.attach=function(t){var e=document.createElement("div");e.id="app",e.innerHTML='\n      <div>\n        <div class="editor-status">状态: <span class="editor-status-text"></span></div>\n        <button class="btn-stop">暂停计时</button>\n        <button class="btn-start">开始计时</button>\n        <button class="btn-finish">结束当前任务</button>\n        <button class="btn-cleardata">清除数据</button>\n      </div>\n      <div class="content-area">\n        <textarea class="item-input"></textarea>\n        <div class="item-list">\n          <div>\n            <span>时间段</span>\n            <span>计时</span>\n            <span>描述</span>\n          </div>\n        </div>\n      </div>\n    ',e.querySelector(".item-input").addEventListener("keydown",this.onTextareaChange);var n=e.querySelector(".btn-stop"),a=e.querySelector(".btn-start"),s=e.querySelector(".btn-finish"),i=e.querySelector(".btn-cleardata");n.addEventListener("click",this.pause),a.addEventListener("click",this.start),s.addEventListener("click",this.finish),i.addEventListener("click",this.clearData),e.querySelector(".item-list").addEventListener("click",this.onListClick),t.appendChild(e),this.elt=e,this.updateStatus(!0),this.update(),this.loopSave()},t}();e["default"]=n},91:function(t,e,n){},92:function(t,e,n){"use strict";e.__esModule=!0;e.database={key:"tl-data",save:function(t){t=JSON.stringify(t);localStorage.setItem(this.key,t)},load:function(){var t=localStorage.getItem(this.key);try{return JSON.parse(t)}catch(e){return null}},clear:function(){localStorage.removeItem(this.key)}}}});
//# sourceMappingURL=v1.js.map?v=ab822023ab