{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/view/v1/index.js","webpack:///./src/view/v1/components/App/index.js","webpack:///./src/view/v1/components/App/utils.js"],"names":["webpackJsonpCallback","data","moduleId","chunkId","chunkIds","moreModules","executeModules","i","resolves","length","Object","prototype","hasOwnProperty","call","installedChunks","push","modules","parentJsonpFunction","shift","deferredModules","apply","checkDeferredModules","result","deferredModule","fulfilled","j","depId","splice","__webpack_require__","s","installedModules","0","exports","module","l","m","c","d","name","getter","o","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","p","oldJsonpFunction","jsonpArray","window","slice","App","attach","document","body","console","log","sum","res","nums","database","clear","savedItems","currentItem","pause","update","e","keyCode","preventDefault","input","target","trim","createItem","now","timeRanges","Date","end","updateStatus","start","elt","item","closest","id","dataset","classList","contains","parentElement","selectedItems","has","add","this","Set","running","load","debug","text","saved","current","loopSave","save","setTimeout","uid","Math","random","toString","newItem","lastRange","bindListEvents","querySelectorAll","forEach","addEventListener","event","edited","find","innerHTML","itemList","querySelector","padStart","v","filler","String","formatTime","date","getHours","getMinutes","formatMilliseconds","seconds","floor","minutes","timeCount","renderItem","timeRange","map","range","join","consumed","selected","filter","totalTime","totalTimeText","html","updateTotal","element","div","createElement","onTextareaChange","stopBtn","startBtn","startFinish","finish","clearData","onListClick","appendChild","str","JSON","stringify","localStorage","setItem","getItem","parse","removeItem"],"mappings":"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","file":"static/js/v1.js?v=ab822023ab","sourcesContent":[" \t// install a JSONP callback for chunk loading\n \tfunction webpackJsonpCallback(data) {\n \t\tvar chunkIds = data[0];\n \t\tvar moreModules = data[1];\n \t\tvar executeModules = data[2];\n\n \t\t// add \"moreModules\" to the modules object,\n \t\t// then flag all \"chunkIds\" as loaded and fire callback\n \t\tvar moduleId, chunkId, i = 0, resolves = [];\n \t\tfor(;i < chunkIds.length; i++) {\n \t\t\tchunkId = chunkIds[i];\n \t\t\tif(Object.prototype.hasOwnProperty.call(installedChunks, chunkId) && installedChunks[chunkId]) {\n \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n \t\t\t}\n \t\t\tinstalledChunks[chunkId] = 0;\n \t\t}\n \t\tfor(moduleId in moreModules) {\n \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n \t\t\t}\n \t\t}\n \t\tif(parentJsonpFunction) parentJsonpFunction(data);\n\n \t\twhile(resolves.length) {\n \t\t\tresolves.shift()();\n \t\t}\n\n \t\t// add entry modules from loaded chunk to deferred list\n \t\tdeferredModules.push.apply(deferredModules, executeModules || []);\n\n \t\t// run deferred modules when all chunks ready\n \t\treturn checkDeferredModules();\n \t};\n \tfunction checkDeferredModules() {\n \t\tvar result;\n \t\tfor(var i = 0; i < deferredModules.length; i++) {\n \t\t\tvar deferredModule = deferredModules[i];\n \t\t\tvar fulfilled = true;\n \t\t\tfor(var j = 1; j < deferredModule.length; j++) {\n \t\t\t\tvar depId = deferredModule[j];\n \t\t\t\tif(installedChunks[depId] !== 0) fulfilled = false;\n \t\t\t}\n \t\t\tif(fulfilled) {\n \t\t\t\tdeferredModules.splice(i--, 1);\n \t\t\t\tresult = __webpack_require__(__webpack_require__.s = deferredModule[0]);\n \t\t\t}\n \t\t}\n\n \t\treturn result;\n \t}\n\n \t// The module cache\n \tvar installedModules = {};\n\n \t// object to store loaded and loading chunks\n \t// undefined = chunk not loaded, null = chunk preloaded/prefetched\n \t// Promise = chunk loading, 0 = chunk loaded\n \tvar installedChunks = {\n \t\t0: 0\n \t};\n\n \tvar deferredModules = [];\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"./\";\n\n \tvar jsonpArray = window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || [];\n \tvar oldJsonpFunction = jsonpArray.push.bind(jsonpArray);\n \tjsonpArray.push = webpackJsonpCallback;\n \tjsonpArray = jsonpArray.slice();\n \tfor(var i = 0; i < jsonpArray.length; i++) webpackJsonpCallback(jsonpArray[i]);\n \tvar parentJsonpFunction = oldJsonpFunction;\n\n\n \t// add entry module to deferred list\n \tdeferredModules.push([48,1]);\n \t// run deferred modules when ready\n \treturn checkDeferredModules();\n","import './index.less'\nimport App from './components/App/index';\n\nApp.new().attach(document.body);\n","import './index.less'\nimport { database } from './utils'\n\n/**\n * @typedef {{start: number; end: number}} TimeRange\n * @typedef {{id: string; text: string; timeRanges: TimeRange[]}} Item\n */\n\nconst isDev = process.env.NODE_ENV === 'development'\n\nlet timer = null\n\nconst log = console.log\n\nconst sum = (...nums) => {\n  let res = 0\n  for (let n of nums) {\n    res += n\n  }\n  return res\n}\n\nclass App {\n  static new () {\n    return new this()\n  }\n\n  constructor() {\n    /** @type {Item | null} */\n    this.currentItem = null\n    /** @type {Item[]} */\n    this.savedItems = []\n    /** @type {HTMLElement} */\n    this.elt = null\n    /** @type {Set<string>} */\n    this.selectedItems = new Set()\n\n    this.running = true\n\n    this.updateStatus()\n\n    isDev && this.debug()\n    this.load()\n  }\n\n  debug() {\n    this.savedItems = [\n      {\n        id: '1',\n        text: 'test 111',\n        timeRanges: [{\n          start: Date.now() - 1000 * 1000,\n          end: Date.now(),\n        }],\n      },\n      {\n        id: '2',\n        text: 'test 333',\n        timeRanges: [{\n          start: Date.now() - 1000 * 1000,\n          end: Date.now(),\n        }],\n      },\n    ]\n    this.selectedItems.add('1')\n    this.selectedItems.add('2')\n  }\n\n  load() {\n    const data = database.load()\n\n    if (data) {\n      this.savedItems = data.saved || []\n      this.currentItem = data.current || null\n    }\n  }\n\n  loopSave() {\n    const data = {\n      saved: this.savedItems,\n      current: this.currentItem,\n    }\n\n    database.save(data)\n\n    timer = setTimeout(() => {\n      this.loopSave()\n    }, 1000);\n  }\n\n  clearData = () => {\n    database.clear()\n    this.savedItems = []\n    this.currentItem = null\n    this.pause = true\n    this.update()\n  }\n\n  /**\n   *\n   * @param {KeyboardEvent} e 输入事件\n   */\n  onTextareaChange = (e) => {\n    // enter 键表示创建事件，不输入\n    if (e.keyCode === 13) {\n      e.preventDefault()\n      let input = e.target\n      let v = input.value\n      if (v.trim().length !== 0) {\n        this.createItem(input.value)\n        input.value = ''\n      }\n    }\n  }\n\n  uid() {\n    return `${Math.random().toString().slice(-5, -1)}-${Date.now().toString().slice(-4)}`\n  }\n\n  createItem(text) {\n    let now = Date.now()\n    if (this.currentItem) {\n      let newItem = this.currentItem\n      let lastRange = newItem.timeRanges[newItem.timeRanges.length - 1]\n\n      // 这里的 lastRange 可能是处于暂停状态的\n      // 暂停状态的时候，当前记录已经保存了结束时间了，不需要更新\n      if (!lastRange.end) {\n        lastRange.end = now\n      }\n\n      this.savedItems.push(newItem)\n    }\n\n    console.log(this.savedItems, this.currentItem)\n\n    this.currentItem = {\n      id: this.uid(),\n      text,\n      timeRanges: [\n        { start: now },\n      ],\n    }\n    this.selectedItems.add(this.currentItem.id)\n\n    this.updateStatus(true)\n    this.update()\n  }\n\n  pause = () => {\n    if (this.currentItem) {\n      let now = Date.now()\n      let timeRanges = this.currentItem.timeRanges\n      let lastRange = timeRanges[timeRanges.length - 1]\n      lastRange.end = now\n    }\n\n    this.updateStatus(false)\n  }\n\n  start = () => {\n    if (this.currentItem) {\n      let now = Date.now()\n      let newRange = { start: now }\n      this.currentItem.timeRanges.push(newRange)\n    }\n\n    this.updateStatus(true)\n  }\n\n  finish = () => {\n    if (this.currentItem) {\n      let now = Date.now()\n      let timeRanges = this.currentItem.timeRanges\n      let lastRange = timeRanges[timeRanges.length - 1]\n      lastRange.end = now\n\n      this.savedItems.push(this.currentItem)\n      this.currentItem = null\n      this.update()\n    }\n\n    this.updateStatus(false)\n  }\n\n  bindListEvents(elt) {\n    let elts = elt.querySelectorAll('div[contenteditable]')\n\n    elts.forEach((e) => {\n      e.addEventListener('blur', (event) => {\n        let item = e.closest('.timeline-item')\n        let id = item.dataset.id\n\n        let edited = null\n        if (this.currentItem && this.currentItem.id === id) {\n          edited = this.currentItem\n        } else {\n          edited = this.savedItems.find((i) => i.id === id)\n        }\n\n        if (edited) {\n          let text = event.target.innerHTML\n          edited.text = text\n        }\n      })\n    })\n  }\n\n  onListClick = (e) => {\n    /** @type {HTMLElement} */\n    let elt = e.target\n    let item = elt.closest('.timeline-item')\n\n    if (item) {\n      let id = item.dataset.id\n\n      if (\n        !elt.classList.contains('timeline-item-text') &&\n        !elt.parentElement.classList.contains('timeline-item-text')\n      ) {\n        if (this.selectedItems.has(id)) {\n          this.selectedItems.delete(id)\n        } else {\n          this.selectedItems.add(id)\n        }\n\n        this.update()\n      }\n    }\n  }\n\n  update() {\n    let itemList = this.elt.querySelector('.item-list')\n\n    const padStart = (v, length, filler = '0') => {\n      v = String(v)\n      while (v.length < length) {\n        v = filler + v\n      }\n\n      return v\n    }\n\n    const formatTime = (n) => {\n      let date = new Date(n)\n      let hour = padStart(date.getHours(), 2)\n      let minutes = padStart(date.getMinutes(), 2)\n      return `${hour}:${minutes}`\n    }\n\n    const formatMilliseconds = (n) => {\n      let seconds = Math.floor(n / 1000)\n      let minutes = Math.floor(seconds / 60)\n      seconds = seconds % 60\n\n      let timeCount = ''\n      if (minutes) {\n        timeCount += `${minutes}m`\n      }\n\n      if (seconds) {\n        timeCount += `${seconds}s`\n      }\n      return timeCount\n    }\n\n    /**\n     * @param {Item} item .\n     */\n    const renderItem = (item) => {\n      let timeRange = item.timeRanges\n        .map((range) => {\n          let text = `${formatTime(range.start)}~`\n          if (range.end) {\n            text += `${formatTime(range.end)}`\n          }\n          return `<div>${text}</div>`\n        })\n        .join('')\n\n      let consumed = 0\n      item.timeRanges.forEach((range) => {\n        if (range.start && range.end) {\n          consumed += range.end - range.start\n        }\n      })\n\n      let timeCount = formatMilliseconds(consumed)\n\n      return `\n        <div\n          class=\"timeline-item ${this.selectedItems.has(item.id) ? 'selected' : ''}\"\n          data-id=\"${item.id}\"\n        >\n          <span>${timeRange}</span>\n          <div class=\"timeline-item-text\" contenteditable=\"true\">${item.text}</div>\n          <span>${timeCount}</span>\n        </div>\n      `\n    }\n\n    let selected = this.savedItems.filter((item) => this.selectedItems.has(item.id))\n    let totalTime = sum(...selected.map((item) => {\n      let s = sum(\n        ...item.timeRanges.map((range) => {\n          return range.end - range.start\n        })\n      )\n      return s\n    }))\n    let totalTimeText = formatMilliseconds(totalTime)\n\n    let html = `\n    <div>\n      <span>时间段</span>\n      <span>描述</span>\n      <span>计时</span>\n    </div>\n    ${this.savedItems.map(renderItem).join('')}\n    ${this.currentItem ? renderItem(this.currentItem) : ''}\n    <div class=\"timeline-stat-item\">\n      <span>统计选中项时间</span>\n      <span>${totalTimeText}</span>\n      <span></span>\n    </div>\n    `\n\n    itemList.innerHTML = html\n\n    this.bindListEvents(itemList)\n  }\n\n  updateTotal() {\n\n  }\n\n  updateStatus(v) {\n    if (this.elt) {\n      let status = this.elt.querySelector('.editor-status-text')\n      status.innerHTML = v ? '计时中...' : '计时暂停'\n    }\n\n    this.running = v\n  }\n\n  attach(element) {\n    let div = document.createElement('div')\n    div.id = 'app'\n\n    div.innerHTML = `\n      <div>\n        <div class=\"editor-status\">状态: <span class=\"editor-status-text\"></span></div>\n        <button class=\"btn-stop\">暂停计时</button>\n        <button class=\"btn-start\">开始计时</button>\n        <button class=\"btn-finish\">结束当前任务</button>\n        <button class=\"btn-cleardata\">清除数据</button>\n      </div>\n      <div class=\"content-area\">\n        <textarea class=\"item-input\"></textarea>\n        <div class=\"item-list\">\n          <div>\n            <span>时间段</span>\n            <span>计时</span>\n            <span>描述</span>\n          </div>\n        </div>\n      </div>\n    `\n\n    /** @type {HTMLTextAreaElement} */\n    let input = div.querySelector('.item-input')\n    input.addEventListener('keydown', this.onTextareaChange)\n\n    let stopBtn = div.querySelector('.btn-stop')\n    let startBtn = div.querySelector('.btn-start')\n    let startFinish = div.querySelector('.btn-finish')\n    let clear = div.querySelector('.btn-cleardata')\n    stopBtn.addEventListener('click', this.pause)\n    startBtn.addEventListener('click', this.start)\n    startFinish.addEventListener('click', this.finish)\n    clear.addEventListener('click', this.clearData)\n\n    let itemList = div.querySelector('.item-list')\n    itemList.addEventListener('click', this.onListClick)\n\n\n    element.appendChild(div)\n\n    this.elt = div\n    this.updateStatus(true)\n    this.update()\n\n    this.loopSave()\n  }\n}\n\nexport default App\n","export const database = {\n  key: 'tl-data',\n  save(data) {\n    let str = JSON.stringify(data)\n    localStorage.setItem(this.key, str)\n  },\n  load() {\n    let str = localStorage.getItem(this.key)\n    try {\n      return JSON.parse(str)\n    } catch {\n      return null\n    }\n  },\n  clear() {\n    localStorage.removeItem(this.key)\n  },\n};\n"],"sourceRoot":""}